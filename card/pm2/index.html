<!DOCTYPE html><html data-n-head data-n-head-ssr><head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="&#x7F16;&#x7A0B;&#x4E2D;&#x5E38;&#x7528;&#x7684;cheatsheets, &#x5305;&#x542B;&#x547D;&#x4EE4;&#x7247;&#x6BB5;&#x6216;&#x8BE6;&#x7EC6;&#x535A;&#x6587;" name="description" data-hid="description"><title data-n-head="true">cheatsheets</title><link data-n-head="true" href="/favicon.ico" rel="icon" type="image/x-icon"><style data-vue-ssr-id="35957dfc:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;-webkit-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;opacity:1;background-color:#efc14e;z-index:999999}</style><style data-vue-ssr-id="2f85da71:0">::-moz-selection{background-color:#d33682;background-color:#f75aa6;color:#eee;text-shadow:none}::selection{background-color:#d33682;background-color:#f75aa6;color:#eee;text-shadow:none}body{margin-top:0;padding-top:0;margin:0;padding:0;font-family:Helvetica Neue,Arial,sans-serif;background-color:#fdf6e3;color:#657b83}.page-header{font-family:Open Sans,Clear Sans,Helvetica Neue,Helvetica,Arial,sans-serif;overflow:visible;height:50px;padding:0 36px;z-index:2;font-size:.85em;color:#7e888b;background:0 0;background-color:#eee8d5}@media (max-width:767px){.page-header{padding:0 10px}}.page-header .btn{display:block;height:50px;padding:0 15px;border-bottom:0;color:#ccc;text-transform:uppercase;line-height:50px;-webkit-box-shadow:none!important;box-shadow:none!important;position:relative;font-size:14px}.page-header .btn img{height:50%;vertical-align:middle}.page-header .edit{color:#b58900;text-decoration:none}.pull-left{float:left}.page-wrapper{padding:25px 36px}@media (max-width:767px){.page-wrapper{padding:25px 10px}}blockquote,dl,li,ol,p,pre,table,ul{margin:15px 0}a,a:active,a:visited{color:#b58900}a:hover{background:#fdf6e3}h1{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;text-transform:capitalize;color:#dc322f}@media (max-width:767px){h1{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}}h1 a{text-decoration:none;color:#268bd2}h1 a+a{margin-left:15px}strong{font-weight:700}.card-container{-webkit-columns:4;-moz-columns:4;columns:4;-webkit-column-gap:20px;-moz-column-gap:20px;column-gap:20px}@media (min-width:992px) and (max-width:1361px){.card-container{-webkit-columns:3;-moz-columns:3;columns:3}}@media (min-width:768px) and (max-width:991px){.card-container{-webkit-columns:2;-moz-columns:2;columns:2}}@media (max-width:767px){.card-container{-webkit-columns:1;-moz-columns:1;columns:1}}.card-container .h2-block{display:block;padding:10px;margin:5px 0;width:100%;background-color:#eee8d5;-webkit-column-break-inside:avoid;page-break-inside:avoid;break-inside:avoid;-webkit-column-break-after:always;page-break-after:always;break-after:always;-webkit-column-break-before:always;page-break-before:always;break-before:always;float:left;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 1px 3px 0 rgba(0,0,0,.12),0 1px 2px 0 rgba(0,0,0,.24);box-shadow:0 1px 3px 0 rgba(0,0,0,.12),0 1px 2px 0 rgba(0,0,0,.24)}.card-container .h2-block h2{color:#b58900;text-transform:capitalize}.card-container .h2-block p{margin:0;color:#1f83a0}.card-container .h2-block code{background:#fdf6e3}.card-container .h2-block pre{margin-left:2em}.card-container .h2-block pre code{white-space:pre-wrap;word-wrap:break-word;font-family:DejaVu Sans Mono,Consolas,Liberation Mono,Menlo,Courier,monospace;background:inherit;font-size:14px}.card-container .h2-block blockquote{border-left:4px solid #ddd;padding:0 15px;color:#777;margin:15px 0}.card-container .h2-block blockquote p{font-size:13px;color:#777}</style>
  </head>
  <body data-n-head>
    <div id="__nuxt" data-server-rendered="true"><div class="nuxt-progress" style="width:0%;height:2px;background-color:#3b8070;opacity:0"></div><div id="__layout"><div><div class="page-header"><a href="/" class="btn pull-left toggle-search" title="search"><img src="/search.svg"></a><a href="https://github.com/MwumLi/cheatsheets/tree/master/markdowns/pm2.md" class="btn pull-left edit" target="_blank">&#x5728; Github &#x4E0A;&#x7F16;&#x8F91;&#x6B64;&#x9875;</a></div><div class="page-wrapper"><h1 id="pm2">PM2</h1>
<p><a href="http://pm2.keymetrics.io/">PM2</a> &#x662F;&#x7528; Node.js &#x5F00;&#x53D1;&#x7684;&#x8FDB;&#x7A0B;&#x7BA1;&#x7406;&#x5DE5;&#x5177;, &#x901A;&#x5E38;&#x7528;&#x4E8E; Node.js &#x5E94;&#x7528;&#x7684;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x8FD0;&#x7EF4;; &#x540C;&#x65F6;, &#x5B83;&#x4E5F;&#x652F;&#x6301;&#x5176;&#x4ED6;&#x591A;&#x79CD;&#x8BED;&#x8A00;(perl/python&#x7B49;)&#x7A0B;&#x5E8F;&#x3002;  </p>
<div class="card-container"><div class="h2-block"><h2 id="-node-">&#x542F;&#x52A8;Node&#x7A0B;&#x5E8F;</h2>
<p>&#x542F;&#x52A8; <code>app.js</code>:  </p>
<pre><code>pm2 start app.js</code></pre><p>&#x547D;&#x540D;&#x4E3A; <code>my-api</code>:  </p>
<pre><code># &#x4E00;&#x822C;&#x547D;&#x540D;&#x4E3A;&#x4E00;&#x4E2A;&#x53EF;&#x8BB0;&#x5FC6;&#x7684;&#x540D;&#x5B57;, &#x65B9;&#x4FBF;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;
pm2 start app.js --name my-api</code></pre><p>&#x4F20;&#x9012;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;:  </p>
<pre><code>pm2 start app.js -- -a 23</code></pre><p>&#x4F20;&#x9012; node V8 &#x9009;&#x9879;&#x7ED9; node &#x8FDB;&#x7A0B;:  </p>
<pre><code># --debug=7001 &#x662F; node v8 &#x7684;&#x8C03;&#x8BD5;&#x670D;&#x52A1;
pm2 start app.js --node-args=&quot;--debug=7001&quot;</code></pre><p>&#x4EE5;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;&#x542F;&#x52A8;:  </p>
<pre><code># &#x5B9E;&#x73B0;&#x8D1F;&#x8F7D;&#x5747;&#x8861;, &#x9AD8;&#x6548;&#x5229;&#x7528; CPU
# &#x4F1A;&#x540C;&#x65F6;&#x542F;&#x52A8; 3 &#x4E2A;&#x5B9E;&#x4F8B;
pm2 start app.js -i 3

# &#x542F;&#x52A8;&#x548C; cpu &#x6570;&#x91CF;&#x7B49;&#x540C;&#x7684;&#x5B9E;&#x4F8B;(&#x63A8;&#x8350;)
pm2 start app.js -i 0</code></pre></div><div class="h2-block"><h2 id="-">&#x542F;&#x52A8;&#x5176;&#x4ED6;&#x8BED;&#x8A00;&#x7A0B;&#x5E8F;</h2>
<p>&#x9ED8;&#x8BA4;&#x652F;&#x6301;&#x7684;&#x8BED;&#x8A00;&#x7C7B;&#x578B;:  </p>
<pre><code># key &#x4E3A;&#x6587;&#x4EF6;&#x540E;&#x7F00;, value &#x4E3A;&#x89E3;&#x91CA;&#x5668;
{
    &quot;.sh&quot;: &quot;bash&quot;,
    &quot;.py&quot;: &quot;python&quot;,
    &quot;.rb&quot;: &quot;ruby&quot;,
    &quot;.coffee&quot; : &quot;coffee&quot;,
    &quot;.php&quot;: &quot;php&quot;,
    &quot;.pl&quot; : &quot;perl&quot;,
    &quot;.js&quot; : &quot;node&quot;
}</code></pre><p>&#x6307;&#x5B9A;&#x89E3;&#x91CA;&#x5668;:  </p>
<pre><code>pm2 start echo.pl --interpreter=perl</code></pre><p>&#x6267;&#x884C;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;:  </p>
<pre><code>pm2 start ./binary-app</code></pre></div><div class="h2-block"><h2 id="-">&#x7BA1;&#x7406;&#x8FDB;&#x7A0B;</h2>
<blockquote>
<p><code>all</code>: &#x8868;&#x793A; pm2 &#x8FDB;&#x7A0B;&#x5217;&#x8868;&#x6240;&#x6709;&#x8FDB;&#x7A0B;</p>
</blockquote>
<p>&#x5217;&#x51FA;&#x6240;&#x6709;&#x8FDB;&#x7A0B;:  </p>
<pre><code>pm2 list
pm2 ls
pm2 status
pm2 ps
pm2 l</code></pre><p>&#x505C;&#x6B62;&#x8FDB;&#x7A0B;:  </p>
<pre><code>pm2 stop &lt;name|id|all&gt;</code></pre><p>&#x505C;&#x6B62;&#x5E76;&#x79FB;&#x9664;&#x8FDB;&#x7A0B;:  </p>
<pre><code>pm2 delete &lt;name|id|all&gt;</code></pre><p>&#x91CD;&#x542F;&#x8FDB;&#x7A0B;:  </p>
<pre><code># start &amp;&amp; start
pm2 restart &lt;name/id|all&gt;</code></pre><p>&#x70ED;&#x542F;&#x52A8;:  </p>
<pre><code># cluster &#x6A21;&#x5F0F;&#x5E76;&#x4E14;&#x662F; http/https &#x5E94;&#x7528;
pm2 reload &lt;name/all&gt;</code></pre><p>&#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x8BE6;&#x7EC6;&#x53C2;&#x6570;:  </p>
<pre><code>pm2 describe &lt;id&gt;
pm2 desc &lt;id&gt;
pm2 info &lt;id&gt;
pm2 show &lt;id&gt;</code></pre><p>&#x91CD;&#x7F6E;&#x8FDB;&#x7A0B;&#x91CD;&#x542F;&#x8BA1;&#x6570;&#x5668;:  </p>
<pre><code># &#x91CD;&#x542F;&#x6B21;&#x6570;&#x5C31;&#x53D8;&#x4E3A; 0
pm2 reset &lt;name/id/all&gt;</code></pre></div><div class="h2-block"><h2 id="-">&#x670D;&#x52A1;</h2>
<p>&#x4EA7;&#x751F;&#x670D;&#x52A1;&#x811A;&#x672C;&#x5E76;&#x52A0;&#x5165;&#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;:  </p>
<pre><code># &#x4E0D;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x5E73;&#x53F0;, &#x4F1A;&#x81EA;&#x52A8;&#x63A2;&#x6D4B;; &#x5982;&#x679C;&#x4E0D;&#x80FD;&#x6267;&#x884C;, &#x4E5F;&#x4F1A;&#x7ED9;&#x51FA;&#x63D0;&#x793A;
pm2 startup</code></pre><p>&#x5378;&#x8F7D;&#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;&#x670D;&#x52A1;:  </p>
<pre><code>pm2 unstartup</code></pre><p>&#x66F4;&#x65B0;&#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;&#x670D;&#x52A1;:  </p>
<pre><code># &#x4EE5;&#x9632; Node &#x5B89;&#x88C5;&#x4F4D;&#x7F6E;&#x53D1;&#x751F;&#x6539;&#x53D8;
# &#x6BD4;&#x5982;&#x65F6;&#x5019; nvm &#x5B89;&#x88C5;/&#x5207;&#x6362;&#x5176;&#x4ED6;&#x7248;&#x672C; node
pm2 unstartup &amp;&amp; pm2 startup</code></pre></div><div class="h2-block"><h2 id="-">&#x8FDB;&#x7A0B;&#x8F6C;&#x50A8;</h2>
<p>&#x4FDD;&#x5B58;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x5217;&#x8868;:  </p>
<pre><code># &#x4FDD;&#x5B58;&#x4F4D;&#x7F6E;: $PM2_HOME/.pm2/dump.pm2
# pm2 &#x5F00;&#x673A;&#x81EA;&#x542F;&#x52A8;&#x670D;&#x52A1;&#x4F1A;&#x5728;&#x673A;&#x5668;&#x91CD;&#x542F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x8FD9;&#x4E9B;&#x670D;&#x52A1; 
pm2 save</code></pre><p>&#x624B;&#x52A8;&#x6062;&#x590D;&#x8FDB;&#x7A0B;:  </p>
<pre><code># &#x624B;&#x52A8;&#x5524;&#x8D77;&#x4EE5;&#x524D;&#x901A;&#x8FC7; `pm2 save` &#x4FDD;&#x5B58;&#x7684;&#x8FDB;&#x7A0B;
pm2 resurrect</code></pre><p>&#x6E05;&#x7A7A;&#x8FDB;&#x7A0B;&#x5217;&#x8868;:  </p>
<pre><code># &#x4F1A;&#x628A;&#x6587;&#x4EF6; $PM2_HOME/.pm2/dump.pm2 &#x6E05;&#x7A7A;
pm2 cleardump</code></pre></div><div class="h2-block"><h2 id="-">&#x65E5;&#x5FD7;</h2>
<p>&#x65E5;&#x5FD7;&#x6587;&#x4EF6;: <code>~/.pm2/logs</code></p>
<p>&#x5B9E;&#x65F6;&#x67E5;&#x770B;&#x65E5;&#x5FD7;:  </p>
<pre><code># &#x9ED8;&#x8BA4;&#x67E5;&#x770B;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7684;&#x65E5;&#x5FD7;
pm2 logs [id|name]</code></pre><p>&#x6E05;&#x7A7A;&#x65E5;&#x5FD7;:  </p>
<pre><code>pm2 flush</code></pre></div></div></div></div></div></div>
  

</body></html>